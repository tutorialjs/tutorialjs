"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}})();!(function(t,e,i){var s=(function(){function t(){var s=arguments.length>0&&arguments[0]!==i?arguments[0]:{},h=s.selector,l=h===i?"tut-action":h,n=s.selectorList,r=n===i?[]:n,a=s.debug,o=a!==i&&a;if(_classCallCheck(this,t),r.length>0)this.elems=this._queryElementList(r);else{if(this.elems=Array.from(e.getElementsByClassName(l)),!this.elems.every((function(t){return t.getAttribute("t-step")})))throw new Error("Not all steps defined");this.elems.sort((function(t,e){return parseInt(t.getAttribute("t-step"))-parseInt(e.getAttribute("t-step"))}))}if(0===this.elems.length)throw new Error("No activities point defined");this.selector=l,this.debug=o,this.step=0,this.animate=!0,this.running=!1,this.animation={running:!1,id:null},this._body=e.getElementsByTagName("body")[0],this._blurElement=this._createBlurElement(),this._highlightBox=this._createHighlightBox()}return _createClass(t,[{key:"start",value:function(){this.debug,this.running||(this.elems[this.step].classList.add("tutorial-highlight"),this._body.appendChild(this._blurElement),this._body.appendChild(this._highlightBox),this._moveHighlightBox(),this.running=!0)}},{key:"close",value:function(){this.running&&(this.elems[this.step].classList.remove("tutorial-highlight"),this._highlightBox.style.transform="",this._body.removeChild(this._blurElement),this._body.removeChild(this._highlightBox),this.running=!1,this.step=0)}},{key:"prev",value:function(){this.running&&(this.animation.running||(this.debug,0===this.step?this.close():(this.elems[this.step].classList.remove("tutorial-highlight"),this.elems[--this.step].classList.add("tutorial-highlight"),this._moveHighlightBox())))}},{key:"next",value:function(){this.running&&(this.animation.running||(this.debug,this.step===this.elems.length-1?this.close():(this.elems[this.step].classList.remove("tutorial-highlight"),this.elems[++this.step].classList.add("tutorial-highlight"),this._moveHighlightBox())))}},{key:"goToStep",value:function(t){if(this.running){if(!this._stepInBounds(t))throw new Error("Step out of bounds.");t!==this.step&&(this.elems[this.step].classList.remove("tutorial-highlight"),this.step=t,this.elems[this.step].classList.add("tutorial-highlight"))}}},{key:"_stepInBounds",value:function(t){return t>=0&&t<this.elems.length}},{key:"_createBlurElement",value:function(){var t=e.createElement("div");return t.classList.add("tutorial-blur"),t}},{key:"_createHighlightBox",value:function(){var t=e.createElement("div"),i=e.createElement("div"),s=e.createElement("i");return t.classList.add("tutorial-wrapper"),i.classList.add("tutorial-background"),s.classList.add("tutorial-index"),t.onlick=function(t){t.preventPropagation()},t.appendChild(i),t.appendChild(s),t}},{key:"_moveHighlightBox",value:function(){if(this.running&&this.animate)this._animateHighlightBox();else{var t=this.elems[this.step].getBoundingClientRect();this._highlightBox.style.top=t.top-12,this._highlightBox.style.left=t.left-12,this._highlightBox.childNodes[0].style.height=t.bottom-t.top+24,this._highlightBox.childNodes[0].style.width=t.width+24}this._highlightBox.childNodes[1].innerText=this.step+1}},{key:"_animateHighlightBox",value:function(){var t=this._highlightBox.getBoundingClientRect(),e=this._highlightBox.childNodes[0].getBoundingClientRect(),i=this.elems[this.step].getBoundingClientRect(),s=this._getTransformValues(this._highlightBox.style.transform,this._highlightBox.childNodes[0].style.transform),h=i.top-12-t.top+s.translateY,l=i.left-12-t.left+s.translateX,n=(i.height+24)/e.height+s.scaleY,r=(i.width+24)/e.width+s.scaleX;this._highlightBox.style.transform="translateX("+l+"px) translateY("+h+"px)",this._highlightBox.childNodes[0].style.transform="scaleX("+r+") scaleY("+n+")"}},{key:"_queryElementList",value:function(t){var s=[],h=null,l=!0,n=!1,r=i;try{for(var a,o=t[Symbol.iterator]();!(l=(a=o.next()).done);l=!0){var u=a.value;switch(u.charAt(0)){case".":h=e.getElementsByClassName(u.substr(1,this.length))[0];break;case"#":h=e.getElementById(u.substr(1,this.length))[0];break;default:throw new Error("Unknown selector. Please only use id or class.")}s.push(h)}}catch(t){n=!0,r=t}finally{try{!l&&o.return&&o.return()}finally{if(n)throw r}}return s}},{key:"_getTransformValues",value:function(t,e){var i={};if(""===t)i={translateY:0,translateX:0,scaleX:0,scaleY:0};else{var s=t.split(" "),h=e.split(" ");i={translateX:parseFloat(s[0].substr(11,this.length).replace("px)","")),translateY:parseFloat(s[1].substr(11,this.length).replace("px)","")),scaleX:parseFloat(h[0].substr(7,this.length).replace("px)",""))-1,scaleY:parseFloat(h[1].substr(7,this.length).replace("px)",""))-1}}return i}}]),t})();t.Tutorial||(t.Tutorial=s)})(window,document);